# é›·ç”µæ¨¡æ‹Ÿå™¨è¿æ¥æŒ‡å—

## ğŸ“± ç¬¬ä¸€æ­¥ï¼šé…ç½®é›·ç”µæ¨¡æ‹Ÿå™¨

### 1. å¼€å¯ ADB è°ƒè¯•

1. æ‰“å¼€é›·ç”µæ¨¡æ‹Ÿå™¨
2. ç‚¹å‡»å³ä¾§å·¥å…·æ çš„"è®¾ç½®"æŒ‰é’®ï¼ˆé½¿è½®å›¾æ ‡ï¼‰
3. è¿›å…¥"å…¶ä»–è®¾ç½®"
4. æ‰¾åˆ°"ADB è°ƒè¯•"ï¼Œå¼€å¯å®ƒ
5. è®°ä¸‹ ADB ç«¯å£å·ï¼ˆé€šå¸¸æ˜¯ 5555ï¼‰

### 2. æŸ¥çœ‹ ADB ç«¯å£

é›·ç”µæ¨¡æ‹Ÿå™¨çš„ ADB ç«¯å£é€šå¸¸æ˜¯ï¼š
- **å•å¼€**: `127.0.0.1:5555`
- **å¤šå¼€**: æ¯ä¸ªå®ä¾‹æœ‰ä¸åŒç«¯å£ï¼ˆ5555, 5557, 5559...ï¼‰

æŸ¥çœ‹ç«¯å£çš„æ–¹æ³•ï¼š
```bash
# æ–¹æ³• 1: åœ¨é›·ç”µæ¨¡æ‹Ÿå™¨å®‰è£…ç›®å½•è¿è¡Œ
cd "C:\LDPlayer\LDPlayer9"
adb.exe devices

# æ–¹æ³• 2: æŸ¥çœ‹é›·ç”µå¤šå¼€å™¨
# æ‰“å¼€é›·ç”µå¤šå¼€å™¨ï¼Œæ¯ä¸ªå®ä¾‹ä¼šæ˜¾ç¤ºç«¯å£å·
```

### 3. å®‰è£… Master Duel

1. åœ¨æ¨¡æ‹Ÿå™¨ä¸­æ‰“å¼€ Google Play å•†åº—
2. æœç´¢ "Yu-Gi-Oh! Master Duel"
3. ä¸‹è½½å¹¶å®‰è£…
4. ç™»å½•ä½ çš„è´¦å·

## ğŸ”§ ç¬¬äºŒæ­¥ï¼šå®‰è£… Python ä¾èµ–

```bash
# å®‰è£…æ‰€æœ‰å¿…éœ€çš„ä¾èµ–
pip install -r requirements.txt

# ç¡®ä¿å®‰è£…äº†è¿™äº›å…³é”®åº“
pip install PyQt5 pure-python-adb opencv-python numpy loguru
```

## ğŸš€ ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•è¿æ¥

### æ–¹æ³• 1: ä½¿ç”¨æµ‹è¯•è„šæœ¬ï¼ˆæ¨èï¼‰

æˆ‘ä¸ºä½ åˆ›å»ºäº†ä¸€ä¸ªä¸“é—¨çš„æµ‹è¯•è„šæœ¬ï¼š

```bash
python test_ldplayer_connection.py
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
- âœ… è‡ªåŠ¨æ£€æµ‹é›·ç”µæ¨¡æ‹Ÿå™¨
- âœ… æµ‹è¯• ADB è¿æ¥
- âœ… æµ‹è¯•æˆªå›¾åŠŸèƒ½
- âœ… æµ‹è¯•ç‚¹å‡»åŠŸèƒ½
- âœ… æ˜¾ç¤ºè®¾å¤‡ä¿¡æ¯

### æ–¹æ³• 2: æ‰‹åŠ¨æµ‹è¯• ADB

```bash
# 1. è¿æ¥åˆ°æ¨¡æ‹Ÿå™¨
adb connect 127.0.0.1:5555

# 2. æŸ¥çœ‹è®¾å¤‡åˆ—è¡¨
adb devices

# åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
# List of devices attached
# 127.0.0.1:5555    device

# 3. æµ‹è¯•æˆªå›¾
adb -s 127.0.0.1:5555 shell screencap -p /sdcard/test.png
adb -s 127.0.0.1:5555 pull /sdcard/test.png

# 4. æµ‹è¯•ç‚¹å‡»
adb -s 127.0.0.1:5555 shell input tap 500 500
```

## ğŸ® ç¬¬å››æ­¥ï¼šå¯åŠ¨è°ƒè¯• UI

```bash
# å¯åŠ¨è°ƒè¯•ç•Œé¢
python debug_ui.py

# æˆ–ä½¿ç”¨å¯åŠ¨è„šæœ¬
start_debug_ui.bat
```

### è°ƒè¯• UI ä½¿ç”¨æ­¥éª¤

1. **æ£€æŸ¥è¿æ¥çŠ¶æ€**
   - æŸ¥çœ‹å³ä¾§"è°ƒè¯•ä¿¡æ¯"æ ‡ç­¾é¡µ
   - ç¡®è®¤è®¾å¤‡ ID æ˜¾ç¤ºä¸º `127.0.0.1:5555`
   - ç¡®è®¤åˆ†è¾¨ç‡æ­£ç¡®æ˜¾ç¤º

2. **æµ‹è¯•æˆªå›¾**
   - ç‚¹å‡»"ğŸ“· æˆªå›¾"æŒ‰é’®
   - æŸ¥çœ‹å·¦ä¾§æ˜¯å¦æ˜¾ç¤ºæ¸¸æˆç”»é¢
   - å¦‚æœæ˜¾ç¤ºé»‘å±ï¼Œæ£€æŸ¥ ADB è¿æ¥

3. **å¼€å¯è‡ªåŠ¨æˆªå›¾**
   - å‹¾é€‰"è‡ªåŠ¨æˆªå›¾"
   - è°ƒæ•´é—´éš”ï¼ˆå»ºè®® 500-1000msï¼‰
   - è§‚å¯Ÿç”»é¢æ˜¯å¦æµç•…æ›´æ–°

4. **æŸ¥çœ‹è¯†åˆ«ç»“æœ**
   - åˆ‡æ¢åˆ°"ğŸ” è¯†åˆ«ç»“æœ"æ ‡ç­¾é¡µ
   - æŸ¥çœ‹æ¸¸æˆçŠ¶æ€ã€å¡ç‰‡è¯†åˆ«ç­‰ä¿¡æ¯
   - å¦‚æœè¯†åˆ«ä¸å‡†ç¡®ï¼Œéœ€è¦è°ƒæ•´æ¨¡æ¿

## ğŸ” ç¬¬äº”æ­¥ï¼šç•Œé¢è¯†åˆ«

### å‡†å¤‡æ¨¡æ¿å›¾åƒ

1. **æˆªå–æ¨¡æ¿**
   ```bash
   # è¿è¡Œæ¨¡æ¿åˆ¶ä½œå·¥å…·
   python tools/create_templates.py
   ```

2. **æ‰‹åŠ¨åˆ¶ä½œæ¨¡æ¿**
   - åœ¨è°ƒè¯• UI ä¸­æˆªå›¾
   - ç‚¹å‡»"ğŸ’¾ ä¿å­˜"ä¿å­˜æˆªå›¾
   - ä½¿ç”¨å›¾åƒç¼–è¾‘å™¨è£å‰ªå‡ºéœ€è¦çš„å…ƒç´ 
   - ä¿å­˜åˆ° `data/templates/` ç›®å½•

3. **å¸¸ç”¨æ¨¡æ¿åˆ—è¡¨**
   ```
   data/templates/
   â”œâ”€â”€ battle/
   â”‚   â”œâ”€â”€ end_turn_button.png      # ç»“æŸå›åˆæŒ‰é’®
   â”‚   â”œâ”€â”€ summon_button.png        # å¬å”¤æŒ‰é’®
   â”‚   â”œâ”€â”€ activate_button.png      # å‘åŠ¨æŒ‰é’®
   â”‚   â”œâ”€â”€ main_phase.png           # ä¸»è¦é˜¶æ®µæŒ‡ç¤ºå™¨
   â”‚   â””â”€â”€ battle_phase.png         # æˆ˜æ–—é˜¶æ®µæŒ‡ç¤ºå™¨
   â”œâ”€â”€ deck_editor/
   â”‚   â”œâ”€â”€ save_button.png          # ä¿å­˜æŒ‰é’®
   â”‚   â”œâ”€â”€ card_slot.png            # å¡æ§½
   â”‚   â””â”€â”€ filter_button.png        # ç­›é€‰æŒ‰é’®
   â””â”€â”€ menu/
       â”œâ”€â”€ duel_button.png          # å†³æ–—æŒ‰é’®
       â”œâ”€â”€ deck_button.png          # å¡ç»„æŒ‰é’®
       â””â”€â”€ solo_mode_button.png     # å•äººæ¨¡å¼æŒ‰é’®
   ```

### æµ‹è¯•è¯†åˆ«

```bash
# è¿è¡Œè¯†åˆ«æµ‹è¯•
python test_recognition.py
```

## ğŸ¤– ç¬¬å…­æ­¥ï¼šè‡ªåŠ¨æ“ä½œ

### åŸºç¡€æ“ä½œç¤ºä¾‹

åˆ›å»ºä¸€ä¸ªç®€å•çš„è‡ªåŠ¨æ“ä½œè„šæœ¬ï¼š

```python
from src.control.adb_controller import ADBController, AndroidGestureController
from src.vision.game_recognizer import SceneDetector
import time

# è¿æ¥è®¾å¤‡
adb = ADBController(emulator_type="LDPlayer")
gesture = AndroidGestureController(adb)
detector = SceneDetector()

# è·å–æˆªå›¾
screenshot = adb.screenshot()

# è¯†åˆ«åœºæ™¯
results = detector.recognize(screenshot)
print(f"å½“å‰åœºæ™¯: {results['scene']}")

# æ ¹æ®åœºæ™¯æ‰§è¡Œæ“ä½œ
if results['scene'] == 'battle':
    # æˆ˜æ–—åœºæ™¯
    if 'end_turn_button' in results.get('buttons', []):
        button = results['buttons']['end_turn_button']
        gesture.natural_tap(button['x'], button['y'])
        print("ç‚¹å‡»äº†ç»“æŸå›åˆæŒ‰é’®")

elif results['scene'] == 'menu':
    # èœå•åœºæ™¯
    if 'duel_button' in results.get('buttons', []):
        button = results['buttons']['duel_button']
        gesture.natural_tap(button['x'], button['y'])
        print("ç‚¹å‡»äº†å†³æ–—æŒ‰é’®")
```

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: æç¤º"æœªæ‰¾åˆ°è®¾å¤‡"

**è§£å†³æ–¹æ³•**:
1. ç¡®ä¿é›·ç”µæ¨¡æ‹Ÿå™¨å·²å¯åŠ¨
2. æ£€æŸ¥ ADB è°ƒè¯•æ˜¯å¦å¼€å¯
3. æ‰‹åŠ¨è¿æ¥ï¼š`adb connect 127.0.0.1:5555`
4. é‡å¯æ¨¡æ‹Ÿå™¨

### Q2: è¿æ¥æˆåŠŸä½†æ— æ³•æˆªå›¾

**è§£å†³æ–¹æ³•**:
1. æ£€æŸ¥æ¨¡æ‹Ÿå™¨æ˜¯å¦æœ‰ Root æƒé™
2. å°è¯•é‡å¯ ADB æœåŠ¡ï¼š
   ```bash
   adb kill-server
   adb start-server
   ```
3. ä½¿ç”¨ç®¡ç†å‘˜æƒé™è¿è¡Œè„šæœ¬

### Q3: æˆªå›¾å¾ˆæ…¢

**è§£å†³æ–¹æ³•**:
1. å®‰è£… pure-python-adbï¼š
   ```bash
   pip install pure-python-adb
   ```
2. é™ä½æˆªå›¾é¢‘ç‡
3. æ£€æŸ¥ç½‘ç»œè¿æ¥

### Q4: è¯†åˆ«ä¸å‡†ç¡®

**è§£å†³æ–¹æ³•**:
1. è°ƒæ•´æ¨¡æ¿åŒ¹é…é˜ˆå€¼
2. é‡æ–°åˆ¶ä½œæ¨¡æ¿ï¼ˆç¡®ä¿æ¸…æ™°ï¼‰
3. æ£€æŸ¥åˆ†è¾¨ç‡æ˜¯å¦åŒ¹é…
4. ä½¿ç”¨æ›´ç²¾ç¡®çš„è¯†åˆ«åŒºåŸŸ

### Q5: å¤šå¼€æ¨¡æ‹Ÿå™¨å¦‚ä½•è¿æ¥

**è§£å†³æ–¹æ³•**:
```python
# æŒ‡å®šç«¯å£è¿æ¥
adb1 = ADBController(device_id="127.0.0.1:5555")  # ç¬¬ä¸€ä¸ªå®ä¾‹
adb2 = ADBController(device_id="127.0.0.1:5557")  # ç¬¬äºŒä¸ªå®ä¾‹
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. æˆªå›¾ä¼˜åŒ–
```python
# ä½¿ç”¨ pure-python-adbï¼ˆå¿« 3-5 å€ï¼‰
pip install pure-python-adb

# é™ä½æˆªå›¾é¢‘ç‡
# å¼€å‘: 500ms
# ç”Ÿäº§: 1000ms
```

### 2. è¯†åˆ«ä¼˜åŒ–
```python
# åªè¯†åˆ«éœ€è¦çš„åŒºåŸŸ
region = screenshot[y1:y2, x1:x2]
result = recognizer.recognize(region)

# ç¼“å­˜è¯†åˆ«ç»“æœ
cache_time = 1.0  # 1ç§’å†…ä½¿ç”¨ç¼“å­˜
```

### 3. æ“ä½œä¼˜åŒ–
```python
# æ‰¹é‡æ“ä½œ
operations = [
    ('tap', 500, 500),
    ('swipe', 100, 100, 500, 500),
    ('tap', 600, 600)
]

for op in operations:
    if op[0] == 'tap':
        gesture.natural_tap(op[1], op[2])
    elif op[0] == 'swipe':
        gesture.natural_swipe(op[1], op[2], op[3], op[4])
```

## ğŸ¯ ä¸‹ä¸€æ­¥

1. âœ… å®Œæˆè¿æ¥æµ‹è¯•
2. âœ… åˆ¶ä½œæ¨¡æ¿å›¾åƒ
3. âœ… æµ‹è¯•è¯†åˆ«åŠŸèƒ½
4. âœ… ç¼–å†™è‡ªåŠ¨åŒ–è„šæœ¬
5. âœ… ä¼˜åŒ–å’Œè°ƒè¯•

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [è°ƒè¯• UI ä½¿ç”¨æŒ‡å—](DEBUG_UI_GUIDE.md)
- [Android è®¾ç½®æŒ‡å—](ANDROID_SETUP_GUIDE.md)
- [è¯†åˆ«ç³»ç»Ÿæ–‡æ¡£](DEBUG_UI_FEATURES.md)

---

**æç¤º**: å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ `logs/` æˆ–åœ¨è°ƒè¯• UI çš„æ—¥å¿—è¾“å‡ºä¸­æŸ¥æ‰¾é”™è¯¯ä¿¡æ¯ã€‚
